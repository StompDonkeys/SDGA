<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disc Golf Stats</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Disc Golf Stats</h1>
    <p><a href="records.html">View Records</a></p> <!-- Link to records page -->
    <div id="stats-container"></div>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>
    <script>
        fetch('data.csv')
            .then(response => response.text())
            .then(csvText => {
                Papa.parse(csvText, {
                    header: true,
                    complete: function(results) {
                        const data = results.data;
                        const players = ['Armygeddon', 'Jobby', 'Bucis', 'Miza'];
                        const filteredData = data.filter(row => players.includes(row.PlayerName));
                        
                        // Sort by StartDate descending (newest first)
                        filteredData.sort((a, b) => new Date(b.StartDate) - new Date(a.StartDate));
                        
                        const container = document.getElementById('stats-container');
                        filteredData.forEach(row => {
                            const card = document.createElement('div');
                            card.className = 'card';
                            
                            const date = new Date(row.StartDate.replace(' ', 'T'));
                            const formattedDate = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
                            
                            card.innerHTML = `
                                <h2>${formattedDate}</h2>
                                <p><strong>Player:</strong> ${row.PlayerName}</p>
                                <p><strong>Course:</strong> ${row.CourseName}</p>
                                <p><strong>Layout:</strong> ${row.LayoutName}</p>
                                <p><strong>Total:</strong> ${row.Total}</p>
                                <p><strong>+/-:</strong> ${row['+/-']}</p>
                                <p><strong>Rating:</strong> ${row.RoundRating || 'N/A'}</p>
                                <button class="toggle-details">Show Details</button>
                                <div class="details" style="display: none;">
                                    <h3>Hole Scores</h3>
                                    <ul>
                                        ${Object.keys(row).filter(key => key.startsWith('Hole')).map(key => `<li>${key}: ${row[key]}</li>`).join('')}
                                    </ul>
                                </div>
                            `;
                            
                            container.appendChild(card);
                        });
                        
                        // Toggle details
                        document.querySelectorAll('.toggle-details').forEach(button => {
                            button.addEventListener('click', () => {
                                const details = button.nextElementSibling;
                                if (details.style.display === 'none') {
                                    details.style.display = 'block';
                                    button.textContent = 'Hide Details';
                                } else {
                                    details.style.display = 'none';
                                    button.textContent = 'Show Details';
                                }
                            });
                        });
                    }
                });
            })
            .catch(error => console.error('Error fetching CSV:', error));
    </script>
</body>
</html>
